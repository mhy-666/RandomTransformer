========================================================================
Batch Inference - Evaluating All Final Models
========================================================================
Base directory: /work/hm235/random_transformer/outputs/from_scratch_31
Output file: all_results.csv
Start time: Mon Jan 19 07:09:31 PM EST 2026
========================================================================
Searching for final_model folders in: /work/hm235/random_transformer/outputs/from_scratch_31
Found 5 final_model folders
================================================================================
Evaluating: baseline_1_full_finetune/baseline_1_full_finetune_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/baseline_1_full_finetune/baseline_1_full_finetune_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 42.47
================================================================================
Evaluating: baseline_2_freeze_attn/baseline_2_freeze_attn_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/baseline_2_freeze_attn/baseline_2_freeze_attn_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 41.69
================================================================================
Evaluating: baseline_3_freeze_mlp/baseline_3_freeze_mlp_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/baseline_3_freeze_mlp/baseline_3_freeze_mlp_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 40.66
================================================================================
Evaluating: exp_1_freeze_attn_mlp/exp_1_freeze_attn_mlp_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/exp_1_freeze_attn_mlp/exp_1_freeze_attn_mlp_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 134.35
================================================================================
Evaluating: exp_2_freeze_attn_mlp_pos/exp_2_freeze_attn_mlp_pos_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/exp_2_freeze_attn_mlp_pos/exp_2_freeze_attn_mlp_pos_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 210.69

================================================================================
Results saved to: /work/hm235/random_transformer/outputs/from_scratch_31/all_results.csv
================================================================================
JSON results saved to: /work/hm235/random_transformer/outputs/from_scratch_31/all_results.json

================================================================================
WikiText-103 Perplexity Summary
================================================================================
Best (lowest) PPL:  40.66
Worst (highest) PPL: 210.69
Mean PPL:           93.97
Median PPL:         42.47

================================================================================
Top 10 Models by WikiText-103 Perplexity (lower is better)
================================================================================
                                                  experiment_name  wikitext103_ppl
        baseline_3_freeze_mlp/baseline_3_freeze_mlp_seed4_qkv_all        40.656094
      baseline_2_freeze_attn/baseline_2_freeze_attn_seed4_qkv_all        41.687168
  baseline_1_full_finetune/baseline_1_full_finetune_seed4_qkv_all        42.471848
        exp_1_freeze_attn_mlp/exp_1_freeze_attn_mlp_seed4_qkv_all       134.353653
exp_2_freeze_attn_mlp_pos/exp_2_freeze_attn_mlp_pos_seed4_qkv_all       210.687531

================================================================================
Bottom 5 Models (highest perplexity)
================================================================================
                                                  experiment_name  wikitext103_ppl
        baseline_3_freeze_mlp/baseline_3_freeze_mlp_seed4_qkv_all        40.656094
      baseline_2_freeze_attn/baseline_2_freeze_attn_seed4_qkv_all        41.687168
  baseline_1_full_finetune/baseline_1_full_finetune_seed4_qkv_all        42.471848
        exp_1_freeze_attn_mlp/exp_1_freeze_attn_mlp_seed4_qkv_all       134.353653
exp_2_freeze_attn_mlp_pos/exp_2_freeze_attn_mlp_pos_seed4_qkv_all       210.687531
========================================================================
Batch inference completed!
End time: Mon Jan 19 08:03:02 PM EST 2026
Results saved to: /work/hm235/random_transformer/outputs/from_scratch_31/all_results.csv
========================================================================
