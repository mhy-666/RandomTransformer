========================================================================
Batch Inference - Evaluating All Final Models
========================================================================
Base directory: /work/hm235/random_transformer/outputs/from_scratch_31
Output file: all_results.csv
Start time: Wed Jan 14 07:16:07 PM EST 2026
========================================================================
Searching for final_model folders in: /work/hm235/random_transformer/outputs/from_scratch_31
Found 5 final_model folders
================================================================================
Evaluating: baseline_1_full_finetune/baseline_1_full_finetune_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/baseline_1_full_finetune/baseline_1_full_finetune_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 58.22
================================================================================
Evaluating: baseline_2_freeze_attn/baseline_2_freeze_attn_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/baseline_2_freeze_attn/baseline_2_freeze_attn_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 42.68
================================================================================
Evaluating: baseline_3_freeze_mlp/baseline_3_freeze_mlp_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/baseline_3_freeze_mlp/baseline_3_freeze_mlp_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 43.49
================================================================================
Evaluating: exp_1_freeze_attn_mlp/exp_1_freeze_attn_mlp_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/exp_1_freeze_attn_mlp/exp_1_freeze_attn_mlp_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 132.35
================================================================================
Evaluating: exp_2_freeze_attn_mlp_pos/exp_2_freeze_attn_mlp_pos_seed4_qkv_all
================================================================================
Loading model from: /work/hm235/random_transformer/outputs/from_scratch_31/exp_2_freeze_attn_mlp_pos/exp_2_freeze_attn_mlp_pos_seed4_qkv_all/final_model
WikiText-103 - Perplexity: 204.91

================================================================================
Results saved to: /work/hm235/random_transformer/outputs/from_scratch_31/all_results.csv
================================================================================
JSON results saved to: /work/hm235/random_transformer/outputs/from_scratch_31/all_results.json

================================================================================
WikiText-103 Perplexity Summary
================================================================================
Best (lowest) PPL:  42.68
Worst (highest) PPL: 204.91
Mean PPL:           96.33
Median PPL:         58.22

================================================================================
Top 10 Models by WikiText-103 Perplexity (lower is better)
================================================================================
                                                  experiment_name  wikitext103_ppl
      baseline_2_freeze_attn/baseline_2_freeze_attn_seed4_qkv_all        42.676842
        baseline_3_freeze_mlp/baseline_3_freeze_mlp_seed4_qkv_all        43.492268
  baseline_1_full_finetune/baseline_1_full_finetune_seed4_qkv_all        58.221420
        exp_1_freeze_attn_mlp/exp_1_freeze_attn_mlp_seed4_qkv_all       132.347092
exp_2_freeze_attn_mlp_pos/exp_2_freeze_attn_mlp_pos_seed4_qkv_all       204.914001

================================================================================
Bottom 5 Models (highest perplexity)
================================================================================
                                                  experiment_name  wikitext103_ppl
      baseline_2_freeze_attn/baseline_2_freeze_attn_seed4_qkv_all        42.676842
        baseline_3_freeze_mlp/baseline_3_freeze_mlp_seed4_qkv_all        43.492268
  baseline_1_full_finetune/baseline_1_full_finetune_seed4_qkv_all        58.221420
        exp_1_freeze_attn_mlp/exp_1_freeze_attn_mlp_seed4_qkv_all       132.347092
exp_2_freeze_attn_mlp_pos/exp_2_freeze_attn_mlp_pos_seed4_qkv_all       204.914001
========================================================================
Batch inference completed!
End time: Wed Jan 14 07:17:39 PM EST 2026
Results saved to: /work/hm235/random_transformer/outputs/from_scratch_31/all_results.csv
========================================================================
